ZAD 1
SELECT 
    CLIENT.CLIENT_ID,
    CLIENT.FULL_NAME
FROM CLIENT
LEFT JOIN `ORDER` ON CLIENT.CLIENT_ID = ORDER.CLIENT_ID
WHERE ORDER.CLIENT_ID IS NULL;

SELECT 
    CLIENT_ID,
    FULL_NAME
FROM CLIENT
WHERE CLIENT_ID NOT IN (
    SELECT CLIENT_ID
    FROM `ORDER`
);


SELECT 
    UNIT.UNIT_NAME
FROM INVENTORY
RIGHT JOIN UNIT ON INVENTORY.UNIT_ID = UNIT.UNIT_ID
WHERE INVENTORY.UNIT_ID IS NULL;


SELECT 
    PRODUCT.PRODUCT_NAME,
    AVG(PRODUCT.PURCHAS_PRICE - PRODUCT.PURCHASE_PRICE) AS price_diff
FROM `ORDER`
JOIN PRODUCT ON `ORDER`.PRODUCT_ID = PRODUCT.PRODUCT_ID
GROUP BY PRODUCT.PRODUCT_ID
ORDER BY price_diff DESC;


SELECT
    PRODUCT.PRODUCT_NAME,
    AVG(ORDER_POSITION.SELL_PRICE - PRODUCT.PURCHASE_PRICE) AS price_diff
FROM ORDER_POSITION
JOIN PRODUCT ON ORDER_POSITION.PRODUCT_ID = PRODUCT.PRODUCT_ID
GROUP BY PRODUCT.PRODUCT_ID, PRODUCT.PRODUCT_NAME
ORDER BY price_diff DESC;



ZAD 2
SELECT DISTINCT
    DEPARTMENT.DEPARTMENT_NAME
FROM `ORDER`
JOIN EMPLOYEE ON `ORDER`.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE_NAME
JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;

SELECT
    DEPARTMENT.DEPARTMENT_NAME,
    SUM(ORDER_POSITION.AMOUNT * ORDER_POSITION.SELL_PRICE) AS total_value
FROM `ORDER`
JOIN ORDER_POSITION ON `ORDER`.ORDER_ID = ORDER_POSITION.ORDER_ID
JOIN EMPLOYEE ON `ORDER`.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE_NAME
JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID
GROUP BY DEPARTMENT.DEPARTMENT_ID, DEPARTMENT.DEPARTMENT_NAME;

SELECT
    DEPARTMENT.DEPARTMENT_NAME,
    ORDER_STATUS.STATUS_NAME,
    SUM(ORDER_POSITION.AMOUNT * ORDER_POSITION.SELL_PRICE) AS total_value
FROM `ORDER`
JOIN ORDER_POSITION ON `ORDER`.ORDER_ID = ORDER_POSITION.ORDER_ID
JOIN EMPLOYEE ON `ORDER`.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE_NAME
JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID
JOIN ORDER_STATUS ON `ORDER`.ORDER_STATUS = ORDER_STATUS.STATUS_ID
GROUP BY
    DEPARTMENT.DEPARTMENT_NAME,
    ORDER_STATUS.STATUS_NAME;

ZAD 3
SELECT 
    CONCAT(PRODUCT_NAME, ' (', DESCRIPTION, ')') AS full_name
FROM PRODUCT;


SELECT 
    CONCAT_WS(', ',
        PRODUCT_ID,
        CATEGORY_ID,
        PRODUCT_NAME,
        PURCHASE_PRICE,
        DESCRIPTION
    ) AS product_line
FROM PRODUCT;


SELECT
    DEPARTMENT.DEPARTMENT_NAME,
    GROUP_CONCAT(CONCAT(EMPLOYEE.FIRST_NAME, ' ', EMPLOYEE.LAST_NAME) SEPARATOR ', ') AS employees
FROM DEPARTMENT
JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID
GROUP BY 
    DEPARTMENT.DEPARTMENT_ID,
    DEPARTMENT.DEPARTMENT_NAME;

SELECT
    CATEGORY.CATEGORY_NAME,
    GROUP_CONCAT(PRODUCT.PRODUCT_NAME SEPARATOR ', ') AS unsold_products
FROM PRODUCT
LEFT JOIN ORDER_POSITION ON PRODUCT.PRODUCT_ID = ORDER_POSITION.PRODUCT_ID
JOIN CATEGORY ON PRODUCT.CATEGORY_ID = CATEGORY.CATEGORY_ID
WHERE ORDER_POSITION.PRODUCT_ID IS NULL
GROUP BY 
    CATEGORY.CATEGORY_ID,
    CATEGORY.CATEGORY_NAME;


ZAD 4
SELECT
    `ORDER`.ORDER_ID,
    IF(`ORDER`.ORDER_STATUS IN (3, 4, 7, 10), 'Zakończone', 'Inny') AS status_text
FROM `ORDER`;


SELECT
    PRODUCT.PRODUCT_NAME,
    CASE
        WHEN INVENTORY.AMOUNT = 0 THEN 'Brak'
        WHEN INVENTORY.AMOUNT > 0 AND INVENTORY.AMOUNT < 10 THEN 'Mała ilość'
        WHEN INVENTORY.AMOUNT >= 10 AND INVENTORY.AMOUNT <= 30 THEN 'Średnia ilość'
        WHEN INVENTORY.AMOUNT > 30 THEN 'Duża ilość'
    END AS dostepnosc
FROM PRODUCT
JOIN INVENTORY ON PRODUCT.PRODUCT_ID = INVENTORY.PRODUCT_ID;


SELECT
    CLIENT.CLIENT_ID,
    IFNULL(CLIENT.TAX_IDENTIFIER, 'Klient indywidualny') AS tax_info
FROM CLIENT;


ZAD 5
SELECT
    CITY,
    SUBSTR(POSTAL_CODE, 1, 2) AS postal_prefix
FROM CLIENT_ADDRESS;

SELECT
    CITY,
    GROUP_CONCAT(DISTINCT SUBSTR(POSTAL_CODE, 1, 2) SEPARATOR ', ') AS postal_prefixes
FROM CLIENT_ADDRESS
GROUP BY 
    CITY;

SELECT
    TRIM(
        SUBSTRING_INDEX(
            SUBSTRING_INDEX(STREET, ' ', 2), 
            ' ', 
            -1
        )
    ) AS street_name
FROM CLIENT_ADDRESS;

