ZAD 1
SELECT AVG(pensja) AS avg_salary FROM EMPLOYEE;

SELECT 
	JOB_POSITION_ID,
	AVG(pensja) AS avg_salary,
	COUNT(*) AS employee_count
FROM EMPLOYEE
GROUP BY JOB_POSITION_ID;

SELECT
	DEPARTMENT_ID,
	AVG(YEAR(CURDATE()) - YEAR(BIRTH_DATE)) as avg_age
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID;


ZAD 2
SELECT 
	DEPARTMENT_ID,
	SUM(pensja) AS total_salary
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID
ORDER BY total_salary DESC;

SELECT 
	JOB_POSITION_ID,
	AVG(pensja) AS avg_salary,
	COUNT(*) AS employee_count
FROM EMPLOYEE
GROUP BY JOB_POSITION_ID
HAVING 
    COUNT(*) >= 3
    AND AVG(pensja) > 3000;

SELECT 
	DEPARTMENT_ID,
	COUNT(DISTINCT pensja) AS distinct_salary_count,
	COUNT(*) AS employee_count
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) > 4
ORDER BY distinct_salary_count ASC;


ZAD 3
CREATE TABLE DEPARTMENT AS
SELECT *
FROM company_2025.DEPARTMENT;
CREATE TABLE JOB_POSITION AS
SELECT *
FROM company_2025.JOB_POSITION;

SELECT 
	DEPARTMENT.DEPARTMENT_NAME AS DEPARTMENT_NAME,
	COUNT(EMPLOYEE.EMPLOYEE_NAME) AS employee_count
FROM DEPARTMENT
LEFT JOIN EMPLOYEE EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID
GROUP BY DEPARTMENT.DEPARTMENT_ID, DEPARTMENT.DEPARTMENT_NAME;

SELECT
	DEPARTMENT.DEPARTMENT_NAME AS department_name,
	CONCAT(EMPLOYEE.FIRST_NAME, ' ', EMPLOYEE.LAST_NAME) AS name
FROM DEPARTMENT DEPARTMENT
JOIN EMPLOYEE EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID
ORDER BY DEPARTMENT.DEPARTMENT_NAME, EMPLOYEE.LAST_NAME, EMPLOYEE.FIRST_NAME;

ZAD 4

SELECT 
	LAST_NAME,
	POSITION_NAME
FROM EMPLOYEE
NATURAL JOIN JOB_POSITION
WHERE YEAR(BIRTH_DATE) BETWEEN 1990 AND 1999;

SELECT 
	FIRST_NAME,
	LAST_NAME,
	BIRTH_DATE
FROM EMPLOYEE
JOIN JOB_POSITION USING (JOB_POSITION_ID)
WHERE POSITION_NAME = 'Magazynier'
ORDER BY BIRTH_DATE DESC
LIMIT 5;

SELECT
	C1.SHORT_NAME AS client1,
	C2.SHORT_NAME AS client2
FROM CLIENT C1
JOIN CLIENT C2 
	ON C1.CLIENT_ID + 5 = C2.CLIENT_ID
ORDER BY C1.CLIENT_ID;

ZAD 5
SELECT 
	JOB_POSITION_ID,
	AVG(pensja) AS avg_salary,
	COUNT(*) AS employee_count
FROM EMPLOYEE
JOIN DEPARTMENT USING (DEPARTMENT_ID)
WHERE DEPARTMENT_NAME NOT IN ('IT', 'HR')
GROUP BY JOB_POSITION_ID
HAVING COUNT(*) > 3;

SELECT
	EMPLOYEE.FIRST_NAME,
	EMPLOYEE.LAST_NAME,
	EMPLOYEE.BIRTH_DATE,
	EMPLOYEE.DEPARTMENT_ID
FROM EMPLOYEE
JOIN (
	SELECT 
		JOB_POSITION_ID,
		MIN(BIRTH_DATE) AS min_birth,
		MAX(BIRTH_DATE) AS max_birth
	FROM EMPLOYEE
	GROUP BY JOB_POSITION_ID
     ) X
ON X.JOB_POSITION_ID = EMPLOYEE.JOB_POSITION_ID
AND (EMPLOYEE.BIRTH_DATE = X.min_birth
	OR EMPLOYEE.BIRTH_DATE = X.max_birth)
ORDER BY DEPARTMENT_ID ASC;









